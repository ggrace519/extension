var sr=Object.defineProperty;var or=(r,e,t)=>e in r?sr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var I=(r,e,t)=>or(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function ue(){}function Bt(r){return r()}function wt(){return Object.create(null)}function he(r){r.forEach(Bt)}function Ot(r){return typeof r=="function"}function Ht(r,e){return r!=r?e==e:r!==e||r&&typeof r=="object"||typeof r=="function"}function ir(r){return Object.keys(r).length===0}function m(r,e){r.appendChild(e)}function K(r,e,t){r.insertBefore(e,t||null)}function Z(r){r.parentNode&&r.parentNode.removeChild(r)}function Nt(r,e){for(let t=0;t<r.length;t+=1)r[t]&&r[t].d(e)}function y(r){return document.createElement(r)}function Re(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function de(r){return document.createTextNode(r)}function C(){return de(" ")}function qt(){return de("")}function N(r,e,t,l){return r.addEventListener(e,t,l),()=>r.removeEventListener(e,t,l)}function ar(r){return function(e){return e.preventDefault(),r.call(this,e)}}function f(r,e,t){t==null?r.removeAttribute(e):r.getAttribute(e)!==t&&r.setAttribute(e,t)}function cr(r){return Array.from(r.childNodes)}function ot(r,e){e=""+e,r.data!==e&&(r.data=e)}function re(r,e){r.value=e??""}function mt(r,e,t){for(let l=0;l<r.options.length;l+=1){const n=r.options[l];if(n.__value===e){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function ur(r){const e=r.querySelector(":checked");return e&&e.__value}class dr{constructor(e=!1){I(this,"is_svg",!1);I(this,"e");I(this,"n");I(this,"t");I(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,l=null){this.e||(this.is_svg?this.e=Re(t.nodeName):this.e=y(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(l)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)K(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Z)}}let Ae;function Te(r){Ae=r}function pr(){if(!Ae)throw new Error("Function called outside component initialization");return Ae}function hr(r){pr().$$.on_mount.push(r)}const me=[],tt=[];let ke=[];const kt=[],fr=Promise.resolve();let rt=!1;function gr(){rt||(rt=!0,fr.then(jt))}function Ze(r){ke.push(r)}const et=new Set;let we=0;function jt(){if(we!==0)return;const r=Ae;do{try{for(;we<me.length;){const e=me[we];we++,Te(e),wr(e.$$)}}catch(e){throw me.length=0,we=0,e}for(Te(null),me.length=0,we=0;tt.length;)tt.pop()();for(let e=0;e<ke.length;e+=1){const t=ke[e];et.has(t)||(et.add(t),t())}ke.length=0}while(me.length);for(;kt.length;)kt.pop()();rt=!1,et.clear(),Te(r)}function wr(r){if(r.fragment!==null){r.update(),he(r.before_update);const e=r.dirty;r.dirty=[-1],r.fragment&&r.fragment.p(r.ctx,e),r.after_update.forEach(Ze)}}function mr(r){const e=[],t=[];ke.forEach(l=>r.indexOf(l)===-1?e.push(l):t.push(l)),t.forEach(l=>l()),ke=e}const Ue=new Set;let kr;function Ut(r,e){r&&r.i&&(Ue.delete(r),r.i(e))}function br(r,e,t,l){if(r&&r.o){if(Ue.has(r))return;Ue.add(r),kr.c.push(()=>{Ue.delete(r)}),r.o(e)}}function De(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function xr(r){r&&r.c()}function Zt(r,e,t){const{fragment:l,after_update:n}=r.$$;l&&l.m(e,t),Ze(()=>{const s=r.$$.on_mount.map(Bt).filter(Ot);r.$$.on_destroy?r.$$.on_destroy.push(...s):he(s),r.$$.on_mount=[]}),n.forEach(Ze)}function Dt(r,e){const t=r.$$;t.fragment!==null&&(mr(t.after_update),he(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function yr(r,e){r.$$.dirty[0]===-1&&(me.push(r),gr(),r.$$.dirty.fill(0)),r.$$.dirty[e/31|0]|=1<<e%31}function Kt(r,e,t,l,n,s,a=null,o=[-1]){const c=Ae;Te(r);const i=r.$$={fragment:null,ctx:[],props:s,update:ue,not_equal:n,bound:wt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:wt(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};a&&a(i.root);let d=!1;if(i.ctx=t?t(r,e.props||{},(g,p,...h)=>{const w=h.length?h[0]:p;return i.ctx&&n(i.ctx[g],i.ctx[g]=w)&&(!i.skip_bound&&i.bound[g]&&i.bound[g](w),d&&yr(r,g)),p}):[],i.update(),d=!0,he(i.before_update),i.fragment=l?l(i.ctx):!1,e.target){if(e.hydrate){const g=cr(e.target);i.fragment&&i.fragment.l(g),g.forEach(Z)}else i.fragment&&i.fragment.c();e.intro&&Ut(r.$$.fragment),Zt(r,e.target,e.anchor),jt()}Te(c)}class Ft{constructor(){I(this,"$$");I(this,"$$set")}$destroy(){Dt(this,1),this.$destroy=ue}$on(e,t){if(!Ot(t))return ue;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const n=l.indexOf(t);n!==-1&&l.splice(n,1)}}$set(e){this.$$set&&!ir(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const _r="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(_r);const bt=async(r,e)=>new Promise((t,l)=>{chrome.runtime.sendMessage({action:"fetchModels",url:e,key:r},n=>{var a;if(chrome.runtime.lastError){l(new Error(chrome.runtime.lastError.message));return}if(n.error){l(n.error);return}let s=((a=n.data)==null?void 0:a.data)??[];s=s.filter(o=>o).sort((o,c)=>{const i=o.name.toLowerCase(),d=c.name.toLowerCase();return i<d?-1:i>d?1:o<c?-1:o>c?1:0}),s.length>0&&console.log(`Extension: Loaded ${s.length} model(s)`),t(s)})}),He=async(r="",e={},t="http://localhost:8080")=>new Promise((l,n)=>{const s=chrome.runtime.connect({name:"chat-stream"});let a=null,o=!1;const c=new ReadableStream({start(d){a=d}});s.onMessage.addListener(d=>{if(d.error){a&&a.error(new Error(d.error)),s.disconnect(),n(new Error(d.error));return}if(d.done){o=!0,a&&a.close(),s.disconnect();return}d.chunk&&a&&a.enqueue(new TextEncoder().encode(d.chunk))}),s.onDisconnect.addListener(()=>{!o&&a&&a.error(new Error("Stream disconnected unexpectedly"))});const i={ok:!0,status:200,body:c};s.postMessage({action:"fetchChatCompletion",url:t,api_key:r,body:e}),l([i,{abort:()=>{s.disconnect()}}])});function it(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var fe=it();function Wt(r){fe=r}var Se={exec:()=>null};function v(r,e=""){let t=typeof r=="string"?r:r.source,l={replace:(n,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(W.caret,"$1"),t=t.replace(n,a),l},getRegex:()=>new RegExp(t,e)};return l}var Er=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),W={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i")},Tr=/^(?:[ \t]*(?:\n|$))+/,Sr=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Rr=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ie=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ar=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,at=/(?:[*+-]|\d{1,9}[.)])/,Qt=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Gt=v(Qt).replace(/bull/g,at).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ir=v(Qt).replace(/bull/g,at).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),ct=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,zr=/^[^\n]+/,ut=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Lr=v(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ut).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),vr=v(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,at).getRegex(),Ye="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",dt=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Pr=v("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",dt).replace("tag",Ye).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Yt=v(ct).replace("hr",Ie).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ye).getRegex(),Cr=v(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Yt).getRegex(),pt={blockquote:Cr,code:Sr,def:Lr,fences:Rr,heading:Ar,hr:Ie,html:Pr,lheading:Gt,list:vr,newline:Tr,paragraph:Yt,table:Se,text:zr},xt=v("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ie).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ye).getRegex(),Mr={...pt,lheading:Ir,table:xt,paragraph:v(ct).replace("hr",Ie).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",xt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ye).getRegex()},Br={...pt,html:v(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",dt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Se,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:v(ct).replace("hr",Ie).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Gt).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Or=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Hr=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Xt=/^( {2,}|\\)\n(?!\s*$)/,Nr=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Xe=/[\p{P}\p{S}]/u,ht=/[\s\p{P}\p{S}]/u,Vt=/[^\s\p{P}\p{S}]/u,qr=v(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,ht).getRegex(),Jt=/(?!~)[\p{P}\p{S}]/u,jr=/(?!~)[\s\p{P}\p{S}]/u,Ur=/(?:[^\s\p{P}\p{S}]|~)/u,Zr=v(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Er?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),$t=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Dr=v($t,"u").replace(/punct/g,Xe).getRegex(),Kr=v($t,"u").replace(/punct/g,Jt).getRegex(),er="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Fr=v(er,"gu").replace(/notPunctSpace/g,Vt).replace(/punctSpace/g,ht).replace(/punct/g,Xe).getRegex(),Wr=v(er,"gu").replace(/notPunctSpace/g,Ur).replace(/punctSpace/g,jr).replace(/punct/g,Jt).getRegex(),Qr=v("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Vt).replace(/punctSpace/g,ht).replace(/punct/g,Xe).getRegex(),Gr=v(/\\(punct)/,"gu").replace(/punct/g,Xe).getRegex(),Yr=v(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Xr=v(dt).replace("(?:-->|$)","-->").getRegex(),Vr=v("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Xr).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ke=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Jr=v(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ke).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),tr=v(/^!?\[(label)\]\[(ref)\]/).replace("label",Ke).replace("ref",ut).getRegex(),rr=v(/^!?\[(ref)\](?:\[\])?/).replace("ref",ut).getRegex(),$r=v("reflink|nolink(?!\\()","g").replace("reflink",tr).replace("nolink",rr).getRegex(),yt=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,ft={_backpedal:Se,anyPunctuation:Gr,autolink:Yr,blockSkip:Zr,br:Xt,code:Hr,del:Se,emStrongLDelim:Dr,emStrongRDelimAst:Fr,emStrongRDelimUnd:Qr,escape:Or,link:Jr,nolink:rr,punctuation:qr,reflink:tr,reflinkSearch:$r,tag:Vr,text:Nr,url:Se},en={...ft,link:v(/^!?\[(label)\]\((.*?)\)/).replace("label",Ke).getRegex(),reflink:v(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ke).getRegex()},nt={...ft,emStrongRDelimAst:Wr,emStrongLDelim:Kr,url:v(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",yt).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:v(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",yt).getRegex()},tn={...nt,br:v(Xt).replace("{2,}","*").getRegex(),text:v(nt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ne={normal:pt,gfm:Mr,pedantic:Br},ye={normal:ft,gfm:nt,breaks:tn,pedantic:en},rn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_t=r=>rn[r];function le(r,e){if(e){if(W.escapeTest.test(r))return r.replace(W.escapeReplace,_t)}else if(W.escapeTestNoEncode.test(r))return r.replace(W.escapeReplaceNoEncode,_t);return r}function Et(r){try{r=encodeURI(r).replace(W.percentDecode,"%")}catch{return null}return r}function Tt(r,e){var s;let t=r.replace(W.findPipe,(a,o,c)=>{let i=!1,d=o;for(;--d>=0&&c[d]==="\\";)i=!i;return i?"|":" |"}),l=t.split(W.splitPipe),n=0;if(l[0].trim()||l.shift(),l.length>0&&!((s=l.at(-1))!=null&&s.trim())&&l.pop(),e)if(l.length>e)l.splice(e);else for(;l.length<e;)l.push("");for(;n<l.length;n++)l[n]=l[n].trim().replace(W.slashPipe,"|");return l}function _e(r,e,t){let l=r.length;if(l===0)return"";let n=0;for(;n<l&&r.charAt(l-n-1)===e;)n++;return r.slice(0,l-n)}function nn(r,e){if(r.indexOf(e[1])===-1)return-1;let t=0;for(let l=0;l<r.length;l++)if(r[l]==="\\")l++;else if(r[l]===e[0])t++;else if(r[l]===e[1]&&(t--,t<0))return l;return t>0?-2:-1}function St(r,e,t,l,n){let s=e.href,a=e.title||null,o=r[1].replace(n.other.outputLinkReplace,"$1");l.state.inLink=!0;let c={type:r[0].charAt(0)==="!"?"image":"link",raw:t,href:s,title:a,text:o,tokens:l.inlineTokens(o)};return l.state.inLink=!1,c}function ln(r,e,t){let l=r.match(t.other.indentCodeCompensation);if(l===null)return e;let n=l[1];return e.split(`
`).map(s=>{let a=s.match(t.other.beginningSpace);if(a===null)return s;let[o]=a;return o.length>=n.length?s.slice(n.length):s}).join(`
`)}var Fe=class{constructor(r){I(this,"options");I(this,"rules");I(this,"lexer");this.options=r||fe}space(r){let e=this.rules.block.newline.exec(r);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(r){let e=this.rules.block.code.exec(r);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:_e(t,`
`)}}}fences(r){let e=this.rules.block.fences.exec(r);if(e){let t=e[0],l=ln(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:l}}}heading(r){let e=this.rules.block.heading.exec(r);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let l=_e(t,"#");(this.options.pedantic||!l||this.rules.other.endingSpaceChar.test(l))&&(t=l.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(r){let e=this.rules.block.hr.exec(r);if(e)return{type:"hr",raw:_e(e[0],`
`)}}blockquote(r){let e=this.rules.block.blockquote.exec(r);if(e){let t=_e(e[0],`
`).split(`
`),l="",n="",s=[];for(;t.length>0;){let a=!1,o=[],c;for(c=0;c<t.length;c++)if(this.rules.other.blockquoteStart.test(t[c]))o.push(t[c]),a=!0;else if(!a)o.push(t[c]);else break;t=t.slice(c);let i=o.join(`
`),d=i.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");l=l?`${l}
${i}`:i,n=n?`${n}
${d}`:d;let g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,s,!0),this.lexer.state.top=g,t.length===0)break;let p=s.at(-1);if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){let h=p,w=h.raw+`
`+t.join(`
`),k=this.blockquote(w);s[s.length-1]=k,l=l.substring(0,l.length-h.raw.length)+k.raw,n=n.substring(0,n.length-h.text.length)+k.text;break}else if((p==null?void 0:p.type)==="list"){let h=p,w=h.raw+`
`+t.join(`
`),k=this.list(w);s[s.length-1]=k,l=l.substring(0,l.length-p.raw.length)+k.raw,n=n.substring(0,n.length-h.raw.length)+k.raw,t=w.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:l,tokens:s,text:n}}}list(r){let e=this.rules.block.list.exec(r);if(e){let t=e[1].trim(),l=t.length>1,n={type:"list",raw:"",ordered:l,start:l?+t.slice(0,-1):"",loose:!1,items:[]};t=l?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=l?t:"[*+-]");let s=this.rules.other.listItemRegex(t),a=!1;for(;r;){let c=!1,i="",d="";if(!(e=s.exec(r))||this.rules.block.hr.test(r))break;i=e[0],r=r.substring(i.length);let g=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,B=>" ".repeat(3*B.length)),p=r.split(`
`,1)[0],h=!g.trim(),w=0;if(this.options.pedantic?(w=2,d=g.trimStart()):h?w=e[1].length+1:(w=e[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,d=g.slice(w),w+=e[1].length),h&&this.rules.other.blankLine.test(p)&&(i+=p+`
`,r=r.substring(p.length+1),c=!0),!c){let B=this.rules.other.nextBulletRegex(w),z=this.rules.other.hrRegex(w),R=this.rules.other.fencesBeginRegex(w),O=this.rules.other.headingBeginRegex(w),Y=this.rules.other.htmlBeginRegex(w);for(;r;){let X=r.split(`
`,1)[0],Q;if(p=X,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),Q=p):Q=p.replace(this.rules.other.tabCharGlobal,"    "),R.test(p)||O.test(p)||Y.test(p)||B.test(p)||z.test(p))break;if(Q.search(this.rules.other.nonSpaceChar)>=w||!p.trim())d+=`
`+Q.slice(w);else{if(h||g.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||R.test(g)||O.test(g)||z.test(g))break;d+=`
`+p}!h&&!p.trim()&&(h=!0),i+=X+`
`,r=r.substring(X.length+1),g=Q.slice(w)}}n.loose||(a?n.loose=!0:this.rules.other.doubleBlankLine.test(i)&&(a=!0));let k=null;this.options.gfm&&(k=this.rules.other.listIsTask.exec(d),k&&(d=d.replace(this.rules.other.listReplaceTask,""))),n.items.push({type:"list_item",raw:i,task:!!k,loose:!1,text:d,tokens:[]}),n.raw+=i}let o=n.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;n.raw=n.raw.trimEnd();for(let c of n.items){if(this.lexer.state.top=!1,c.tokens=this.lexer.blockTokens(c.text,[]),c.task){let i=this.rules.other.listTaskCheckbox.exec(c.raw);if(i){let d={type:"checkbox",raw:i[0]+" ",checked:i[0]!=="[ ]"};c.checked=d.checked,n.loose?c.tokens[0]&&["paragraph","text"].includes(c.tokens[0].type)&&"tokens"in c.tokens[0]&&c.tokens[0].tokens?(c.tokens[0].raw=d.raw+c.tokens[0].raw,c.tokens[0].text=d.raw+c.tokens[0].text,c.tokens[0].tokens.unshift(d)):c.tokens.unshift({type:"paragraph",raw:d.raw,text:d.raw,tokens:[d]}):c.tokens.unshift(d)}}if(!n.loose){let i=c.tokens.filter(g=>g.type==="space"),d=i.length>0&&i.some(g=>this.rules.other.anyLine.test(g.raw));n.loose=d}}if(n.loose)for(let c of n.items){c.loose=!0;for(let i of c.tokens)i.type==="text"&&(i.type="paragraph")}return n}}html(r){let e=this.rules.block.html.exec(r);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(r){let e=this.rules.block.def.exec(r);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),l=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:l,title:n}}}table(r){var a;let e=this.rules.block.table.exec(r);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=Tt(e[1]),l=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===l.length){for(let o of l)this.rules.other.tableAlignRight.test(o)?s.align.push("right"):this.rules.other.tableAlignCenter.test(o)?s.align.push("center"):this.rules.other.tableAlignLeft.test(o)?s.align.push("left"):s.align.push(null);for(let o=0;o<t.length;o++)s.header.push({text:t[o],tokens:this.lexer.inline(t[o]),header:!0,align:s.align[o]});for(let o of n)s.rows.push(Tt(o,s.header.length).map((c,i)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:s.align[i]})));return s}}lheading(r){let e=this.rules.block.lheading.exec(r);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(r){let e=this.rules.block.paragraph.exec(r);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(r){let e=this.rules.block.text.exec(r);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(r){let e=this.rules.inline.escape.exec(r);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(r){let e=this.rules.inline.tag.exec(r);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(r){let e=this.rules.inline.link.exec(r);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let s=_e(t.slice(0,-1),"\\");if((t.length-s.length)%2===0)return}else{let s=nn(e[2],"()");if(s===-2)return;if(s>-1){let a=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let l=e[2],n="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(l);s&&(l=s[1],n=s[3])}else n=e[3]?e[3].slice(1,-1):"";return l=l.trim(),this.rules.other.startAngleBracket.test(l)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?l=l.slice(1):l=l.slice(1,-1)),St(e,{href:l&&l.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(r,e){let t;if((t=this.rules.inline.reflink.exec(r))||(t=this.rules.inline.nolink.exec(r))){let l=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=e[l.toLowerCase()];if(!n){let s=t[0].charAt(0);return{type:"text",raw:s,text:s}}return St(t,n,t[0],this.lexer,this.rules)}}emStrong(r,e,t=""){let l=this.rules.inline.emStrongLDelim.exec(r);if(!(!l||l[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(l[1]||l[2])||!t||this.rules.inline.punctuation.exec(t))){let n=[...l[0]].length-1,s,a,o=n,c=0,i=l[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(i.lastIndex=0,e=e.slice(-1*r.length+n);(l=i.exec(e))!=null;){if(s=l[1]||l[2]||l[3]||l[4]||l[5]||l[6],!s)continue;if(a=[...s].length,l[3]||l[4]){o+=a;continue}else if((l[5]||l[6])&&n%3&&!((n+a)%3)){c+=a;continue}if(o-=a,o>0)continue;a=Math.min(a,a+o+c);let d=[...l[0]][0].length,g=r.slice(0,n+l.index+d+a);if(Math.min(n,a)%2){let h=g.slice(1,-1);return{type:"em",raw:g,text:h,tokens:this.lexer.inlineTokens(h)}}let p=g.slice(2,-2);return{type:"strong",raw:g,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(r){let e=this.rules.inline.code.exec(r);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),l=this.rules.other.nonSpaceChar.test(t),n=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return l&&n&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(r){let e=this.rules.inline.br.exec(r);if(e)return{type:"br",raw:e[0]}}del(r){let e=this.rules.inline.del.exec(r);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(r){let e=this.rules.inline.autolink.exec(r);if(e){let t,l;return e[2]==="@"?(t=e[1],l="mailto:"+t):(t=e[1],l=t),{type:"link",raw:e[0],text:t,href:l,tokens:[{type:"text",raw:t,text:t}]}}}url(r){var t;let e;if(e=this.rules.inline.url.exec(r)){let l,n;if(e[2]==="@")l=e[0],n="mailto:"+l;else{let s;do s=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(s!==e[0]);l=e[0],e[1]==="www."?n="http://"+e[0]:n=e[0]}return{type:"link",raw:e[0],text:l,href:n,tokens:[{type:"text",raw:l,text:l}]}}}inlineText(r){let e=this.rules.inline.text.exec(r);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},ee=class lt{constructor(e){I(this,"tokens");I(this,"options");I(this,"state");I(this,"tokenizer");I(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||fe,this.options.tokenizer=this.options.tokenizer||new Fe,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:W,block:Ne.normal,inline:ye.normal};this.options.pedantic?(t.block=Ne.pedantic,t.inline=ye.pedantic):this.options.gfm&&(t.block=Ne.gfm,this.options.breaks?t.inline=ye.breaks:t.inline=ye.gfm),this.tokenizer.rules=t}static get rules(){return{block:Ne,inline:ye}}static lex(e,t){return new lt(t).lex(e)}static lexInline(e,t){return new lt(t).inlineTokens(e)}lex(e){e=e.replace(W.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let l=this.inlineQueue[t];this.inlineTokens(l.src,l.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],l=!1){var n,s,a;for(this.options.pedantic&&(e=e.replace(W.tabCharGlobal,"    ").replace(W.spaceLine,""));e;){let o;if((s=(n=this.options.extensions)==null?void 0:n.block)!=null&&s.some(i=>(o=i.call({lexer:this},e,t))?(e=e.substring(o.raw.length),t.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);let i=t.at(-1);o.raw.length===1&&i!==void 0?i.raw+=`
`:t.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);let i=t.at(-1);(i==null?void 0:i.type)==="paragraph"||(i==null?void 0:i.type)==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.text,this.inlineQueue.at(-1).src=i.text):t.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);let i=t.at(-1);(i==null?void 0:i.type)==="paragraph"||(i==null?void 0:i.type)==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title},t.push(o));continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),t.push(o);continue}let c=e;if((a=this.options.extensions)!=null&&a.startBlock){let i=1/0,d=e.slice(1),g;this.options.extensions.startBlock.forEach(p=>{g=p.call({lexer:this},d),typeof g=="number"&&g>=0&&(i=Math.min(i,g))}),i<1/0&&i>=0&&(c=e.substring(0,i+1))}if(this.state.top&&(o=this.tokenizer.paragraph(c))){let i=t.at(-1);l&&(i==null?void 0:i.type)==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):t.push(o),l=c.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);let i=t.at(-1);(i==null?void 0:i.type)==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):t.push(o);continue}if(e){let i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var c,i,d,g,p;let l=e,n=null;if(this.tokens.links){let h=Object.keys(this.tokens.links);if(h.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)h.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,n.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s;for(;(n=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)s=n[2]?n[2].length:0,l=l.slice(0,n.index+s)+"["+"a".repeat(n[0].length-s-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);l=((i=(c=this.options.hooks)==null?void 0:c.emStrongMask)==null?void 0:i.call({lexer:this},l))??l;let a=!1,o="";for(;e;){a||(o=""),a=!1;let h;if((g=(d=this.options.extensions)==null?void 0:d.inline)!=null&&g.some(k=>(h=k.call({lexer:this},e,t))?(e=e.substring(h.raw.length),t.push(h),!0):!1))continue;if(h=this.tokenizer.escape(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.tag(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.link(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(h.raw.length);let k=t.at(-1);h.type==="text"&&(k==null?void 0:k.type)==="text"?(k.raw+=h.raw,k.text+=h.text):t.push(h);continue}if(h=this.tokenizer.emStrong(e,l,o)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.codespan(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.br(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.del(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.autolink(e)){e=e.substring(h.raw.length),t.push(h);continue}if(!this.state.inLink&&(h=this.tokenizer.url(e))){e=e.substring(h.raw.length),t.push(h);continue}let w=e;if((p=this.options.extensions)!=null&&p.startInline){let k=1/0,B=e.slice(1),z;this.options.extensions.startInline.forEach(R=>{z=R.call({lexer:this},B),typeof z=="number"&&z>=0&&(k=Math.min(k,z))}),k<1/0&&k>=0&&(w=e.substring(0,k+1))}if(h=this.tokenizer.inlineText(w)){e=e.substring(h.raw.length),h.raw.slice(-1)!=="_"&&(o=h.raw.slice(-1)),a=!0;let k=t.at(-1);(k==null?void 0:k.type)==="text"?(k.raw+=h.raw,k.text+=h.text):t.push(h);continue}if(e){let k="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(k);break}else throw new Error(k)}}return t}},We=class{constructor(r){I(this,"options");I(this,"parser");this.options=r||fe}space(r){return""}code({text:r,lang:e,escaped:t}){var s;let l=(s=(e||"").match(W.notSpaceStart))==null?void 0:s[0],n=r.replace(W.endingNewline,"")+`
`;return l?'<pre><code class="language-'+le(l)+'">'+(t?n:le(n,!0))+`</code></pre>
`:"<pre><code>"+(t?n:le(n,!0))+`</code></pre>
`}blockquote({tokens:r}){return`<blockquote>
${this.parser.parse(r)}</blockquote>
`}html({text:r}){return r}def(r){return""}heading({tokens:r,depth:e}){return`<h${e}>${this.parser.parseInline(r)}</h${e}>
`}hr(r){return`<hr>
`}list(r){let e=r.ordered,t=r.start,l="";for(let a=0;a<r.items.length;a++){let o=r.items[a];l+=this.listitem(o)}let n=e?"ol":"ul",s=e&&t!==1?' start="'+t+'"':"";return"<"+n+s+`>
`+l+"</"+n+`>
`}listitem(r){return`<li>${this.parser.parse(r.tokens)}</li>
`}checkbox({checked:r}){return"<input "+(r?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:r}){return`<p>${this.parser.parseInline(r)}</p>
`}table(r){let e="",t="";for(let n=0;n<r.header.length;n++)t+=this.tablecell(r.header[n]);e+=this.tablerow({text:t});let l="";for(let n=0;n<r.rows.length;n++){let s=r.rows[n];t="";for(let a=0;a<s.length;a++)t+=this.tablecell(s[a]);l+=this.tablerow({text:t})}return l&&(l=`<tbody>${l}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+l+`</table>
`}tablerow({text:r}){return`<tr>
${r}</tr>
`}tablecell(r){let e=this.parser.parseInline(r.tokens),t=r.header?"th":"td";return(r.align?`<${t} align="${r.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:r}){return`<strong>${this.parser.parseInline(r)}</strong>`}em({tokens:r}){return`<em>${this.parser.parseInline(r)}</em>`}codespan({text:r}){return`<code>${le(r,!0)}</code>`}br(r){return"<br>"}del({tokens:r}){return`<del>${this.parser.parseInline(r)}</del>`}link({href:r,title:e,tokens:t}){let l=this.parser.parseInline(t),n=Et(r);if(n===null)return l;r=n;let s='<a href="'+r+'"';return e&&(s+=' title="'+le(e)+'"'),s+=">"+l+"</a>",s}image({href:r,title:e,text:t,tokens:l}){l&&(t=this.parser.parseInline(l,this.parser.textRenderer));let n=Et(r);if(n===null)return le(t);r=n;let s=`<img src="${r}" alt="${t}"`;return e&&(s+=` title="${le(e)}"`),s+=">",s}text(r){return"tokens"in r&&r.tokens?this.parser.parseInline(r.tokens):"escaped"in r&&r.escaped?r.text:le(r.text)}},gt=class{strong({text:r}){return r}em({text:r}){return r}codespan({text:r}){return r}del({text:r}){return r}html({text:r}){return r}text({text:r}){return r}link({text:r}){return""+r}image({text:r}){return""+r}br(){return""}checkbox({raw:r}){return r}},te=class st{constructor(e){I(this,"options");I(this,"renderer");I(this,"textRenderer");this.options=e||fe,this.options.renderer=this.options.renderer||new We,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new gt}static parse(e,t){return new st(t).parse(e)}static parseInline(e,t){return new st(t).parseInline(e)}parse(e){var l,n;let t="";for(let s=0;s<e.length;s++){let a=e[s];if((n=(l=this.options.extensions)==null?void 0:l.renderers)!=null&&n[a.type]){let c=a,i=this.options.extensions.renderers[c.type].call({parser:this},c);if(i!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(c.type)){t+=i||"";continue}}let o=a;switch(o.type){case"space":{t+=this.renderer.space(o);break}case"hr":{t+=this.renderer.hr(o);break}case"heading":{t+=this.renderer.heading(o);break}case"code":{t+=this.renderer.code(o);break}case"table":{t+=this.renderer.table(o);break}case"blockquote":{t+=this.renderer.blockquote(o);break}case"list":{t+=this.renderer.list(o);break}case"checkbox":{t+=this.renderer.checkbox(o);break}case"html":{t+=this.renderer.html(o);break}case"def":{t+=this.renderer.def(o);break}case"paragraph":{t+=this.renderer.paragraph(o);break}case"text":{t+=this.renderer.text(o);break}default:{let c='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return t}parseInline(e,t=this.renderer){var n,s;let l="";for(let a=0;a<e.length;a++){let o=e[a];if((s=(n=this.options.extensions)==null?void 0:n.renderers)!=null&&s[o.type]){let i=this.options.extensions.renderers[o.type].call({parser:this},o);if(i!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){l+=i||"";continue}}let c=o;switch(c.type){case"escape":{l+=t.text(c);break}case"html":{l+=t.html(c);break}case"link":{l+=t.link(c);break}case"image":{l+=t.image(c);break}case"checkbox":{l+=t.checkbox(c);break}case"strong":{l+=t.strong(c);break}case"em":{l+=t.em(c);break}case"codespan":{l+=t.codespan(c);break}case"br":{l+=t.br(c);break}case"del":{l+=t.del(c);break}case"text":{l+=t.text(c);break}default:{let i='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return l}},je,Ee=(je=class{constructor(r){I(this,"options");I(this,"block");this.options=r||fe}preprocess(r){return r}postprocess(r){return r}processAllTokens(r){return r}emStrongMask(r){return r}provideLexer(){return this.block?ee.lex:ee.lexInline}provideParser(){return this.block?te.parse:te.parseInline}},I(je,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),I(je,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),je),sn=class{constructor(...r){I(this,"defaults",it());I(this,"options",this.setOptions);I(this,"parse",this.parseMarkdown(!0));I(this,"parseInline",this.parseMarkdown(!1));I(this,"Parser",te);I(this,"Renderer",We);I(this,"TextRenderer",gt);I(this,"Lexer",ee);I(this,"Tokenizer",Fe);I(this,"Hooks",Ee);this.use(...r)}walkTokens(r,e){var l,n;let t=[];for(let s of r)switch(t=t.concat(e.call(this,s)),s.type){case"table":{let a=s;for(let o of a.header)t=t.concat(this.walkTokens(o.tokens,e));for(let o of a.rows)for(let c of o)t=t.concat(this.walkTokens(c.tokens,e));break}case"list":{let a=s;t=t.concat(this.walkTokens(a.items,e));break}default:{let a=s;(n=(l=this.defaults.extensions)==null?void 0:l.childTokens)!=null&&n[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{let c=a[o].flat(1/0);t=t.concat(this.walkTokens(c,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}use(...r){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return r.forEach(t=>{let l={...t};if(l.async=this.defaults.async||l.async||!1,t.extensions&&(t.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){let s=e.renderers[n.name];s?e.renderers[n.name]=function(...a){let o=n.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=e[n.level];s?s.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),l.extensions=e),t.renderer){let n=this.defaults.renderer||new We(this.defaults);for(let s in t.renderer){if(!(s in n))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let a=s,o=t.renderer[a],c=n[a];n[a]=(...i)=>{let d=o.apply(n,i);return d===!1&&(d=c.apply(n,i)),d||""}}l.renderer=n}if(t.tokenizer){let n=this.defaults.tokenizer||new Fe(this.defaults);for(let s in t.tokenizer){if(!(s in n))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let a=s,o=t.tokenizer[a],c=n[a];n[a]=(...i)=>{let d=o.apply(n,i);return d===!1&&(d=c.apply(n,i)),d}}l.tokenizer=n}if(t.hooks){let n=this.defaults.hooks||new Ee;for(let s in t.hooks){if(!(s in n))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let a=s,o=t.hooks[a],c=n[a];Ee.passThroughHooks.has(s)?n[a]=i=>{if(this.defaults.async&&Ee.passThroughHooksRespectAsync.has(s))return(async()=>{let g=await o.call(n,i);return c.call(n,g)})();let d=o.call(n,i);return c.call(n,d)}:n[a]=(...i)=>{if(this.defaults.async)return(async()=>{let g=await o.apply(n,i);return g===!1&&(g=await c.apply(n,i)),g})();let d=o.apply(n,i);return d===!1&&(d=c.apply(n,i)),d}}l.hooks=n}if(t.walkTokens){let n=this.defaults.walkTokens,s=t.walkTokens;l.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),n&&(o=o.concat(n.call(this,a))),o}}this.defaults={...this.defaults,...l}}),this}setOptions(r){return this.defaults={...this.defaults,...r},this}lexer(r,e){return ee.lex(r,e??this.defaults)}parser(r,e){return te.parse(r,e??this.defaults)}parseMarkdown(r){return(e,t)=>{let l={...t},n={...this.defaults,...l},s=this.onError(!!n.silent,!!n.async);if(this.defaults.async===!0&&l.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=r),n.async)return(async()=>{let a=n.hooks?await n.hooks.preprocess(e):e,o=await(n.hooks?await n.hooks.provideLexer():r?ee.lex:ee.lexInline)(a,n),c=n.hooks?await n.hooks.processAllTokens(o):o;n.walkTokens&&await Promise.all(this.walkTokens(c,n.walkTokens));let i=await(n.hooks?await n.hooks.provideParser():r?te.parse:te.parseInline)(c,n);return n.hooks?await n.hooks.postprocess(i):i})().catch(s);try{n.hooks&&(e=n.hooks.preprocess(e));let a=(n.hooks?n.hooks.provideLexer():r?ee.lex:ee.lexInline)(e,n);n.hooks&&(a=n.hooks.processAllTokens(a)),n.walkTokens&&this.walkTokens(a,n.walkTokens);let o=(n.hooks?n.hooks.provideParser():r?te.parse:te.parseInline)(a,n);return n.hooks&&(o=n.hooks.postprocess(o)),o}catch(a){return s(a)}}}onError(r,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,r){let l="<p>An error occurred:</p><pre>"+le(t.message+"",!0)+"</pre>";return e?Promise.resolve(l):l}if(e)return Promise.reject(t);throw t}}},pe=new sn;function P(r,e){return pe.parse(r,e)}P.options=P.setOptions=function(r){return pe.setOptions(r),P.defaults=pe.defaults,Wt(P.defaults),P};P.getDefaults=it;P.defaults=fe;P.use=function(...r){return pe.use(...r),P.defaults=pe.defaults,Wt(P.defaults),P};P.walkTokens=function(r,e){return pe.walkTokens(r,e)};P.parseInline=pe.parseInline;P.Parser=te;P.parser=te.parse;P.Renderer=We;P.TextRenderer=gt;P.Lexer=ee;P.lexer=ee.lex;P.Tokenizer=Fe;P.Hooks=Ee;P.parse=P;P.options;P.setOptions;P.use;P.walkTokens;P.parseInline;te.parse;ee.lex;const qe=r=>{let e="";return new TransformStream({transform(t,l){e+=t;const n=e.split(r);n.slice(0,-1).forEach(s=>l.enqueue(s)),e=n[n.length-1]},flush(t){e&&t.enqueue(e)}})};P.setOptions({breaks:!0,gfm:!0,headerIds:!1,mangle:!1});const Qe=r=>{if(!r)return"";try{return P.parse(r)}catch(e){return console.error("Error rendering markdown:",e),r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}};function Rt(r,e,t){const l=r.slice();return l[36]=e[t],l[38]=t,l}function At(r,e,t){const l=r.slice();return l[15]=e[t],l}function It(r){let e,t,l;function n(o,c){return o[1]?an:on}let s=n(r),a=s(r);return{c(){e=y("div"),a.c(),f(e,"class","tlwd-fixed tlwd-top-0 tlwd-right-0 tlwd-left-0 tlwd-bottom-0 tlwd-w-full tlwd-min-h-screen tlwd-h-screen tlwd-flex tlwd-justify-center tlwd-z-[9999999999] tlwd-overflow-hidden tlwd-overscroll-contain")},m(o,c){K(o,e,c),a.m(e,null),t||(l=N(e,"mousedown",r[26]),t=!0)},p(o,c){s===(s=n(o))&&a?a.p(o,c):(a.d(1),a=s(o),a&&(a.c(),a.m(e,null)))},d(o){o&&Z(e),a.d(),t=!1,l()}}}function on(r){let e,t,l,n,s,a,o,c,i,d,g,p,h,w;return{c(){e=y("div"),t=y("div"),l=y("form"),n=y("div"),s=y("div"),s.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg>`,a=C(),o=y("input"),c=C(),i=y("div"),d=y("div"),d.textContent="Press âŒ˜Space+Shift to toggle",g=C(),p=y("button"),p.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-3"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path></svg>`,f(s,"class","tlwd-flex tlwd-items-center"),f(o,"id","open-webui-search-input"),f(o,"placeholder","Search Open WebUI"),f(o,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),f(o,"autocomplete","one-time-code"),f(n,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full"),f(d,"class","tlwd-text-right tlwd-text-[0.7rem] tlwd-p-0 tlwd-m-0 tlwd-text-neutral-300 tlwd-h-fit"),f(p,"class","tlwd-h-fit tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),f(p,"type","button"),f(i,"class","tlwd-flex tlwd-justify-end tlwd-gap-1 tlwd-items-center"),f(l,"class","tlwd-text-gray-200 tlwd-w-full tlwd-p-0 tlwd-m-0"),f(l,"autocomplete","off"),f(t,"class","tlwd-w-full tlwd-flex tlwd-flex-col tlwd-justify-between tlwd-py-2.5 tlwd-px-3.5 tlwd-rounded-2xl tlwd-outline tlwd-outline-1 tlwd-outline-gray-850 tlwd-backdrop-blur-3xl tlwd-bg-gray-850/70 shadow-4xl modal-animation"),f(e,"class","tlwd-m-auto tlwd-max-w-xl tlwd-w-full tlwd-pb-32")},m(k,B){K(k,e,B),m(e,t),m(t,l),m(l,n),m(n,s),m(n,a),m(n,o),re(o,r[12]),m(l,c),m(l,i),m(i,d),m(i,g),m(i,p),h||(w=[N(o,"input",r[24]),N(p,"click",r[25]),N(l,"submit",r[16]),N(l,"mousedown",gn)],h=!0)},p(k,B){B[0]&4096&&o.value!==k[12]&&re(o,k[12])},d(k){k&&Z(e),h=!1,he(w)}}}function an(r){let e,t,l,n,s,a,o,c,i,d,g,p,h,w,k,B,z,R=r[13]&&r[13].length>0&&zt(r);return{c(){e=y("div"),t=y("div"),l=y("form"),n=y("div"),s=y("div"),s.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"></path></svg>`,a=C(),o=y("input"),c=C(),i=y("div"),d=y("div"),d.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"></path></svg>`,g=C(),p=y("input"),h=C(),w=y("button"),w.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg>`,k=C(),R&&R.c(),f(s,"class","tlwd-flex tlwd-items-center"),f(o,"id","open-webui-url-input"),f(o,"placeholder","Open WebUI URL"),f(o,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),f(o,"autocomplete","one-time-code"),o.required=!0,f(n,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full"),f(d,"class","tlwd-flex tlwd-items-center"),f(p,"placeholder","Open WebUI API Key"),f(p,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),f(p,"autocomplete","one-time-code"),p.required=!0,f(w,"class","tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),f(w,"type","button"),f(i,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full tlwd-mt-2"),f(l,"class","tlwd-text-gray-200 tlwd-w-full tlwd-p-0 tlwd-m-0"),f(l,"autocomplete","off"),f(t,"class","tlwd-w-full tlwd-flex tlwd-flex-col tlwd-justify-between tlwd-py-2.5 tlwd-px-3.5 tlwd-rounded-2xl tlwd-outline tlwd-outline-1 tlwd-outline-gray-850 tlwd-backdrop-blur-3xl tlwd-bg-gray-850/70 shadow-4xl modal-animation"),f(e,"class","tlwd-m-auto tlwd-max-w-sm tlwd-w-full tlwd-pb-32")},m(O,Y){K(O,e,Y),m(e,t),m(t,l),m(l,n),m(n,s),m(n,a),m(n,o),re(o,r[10]),m(l,c),m(l,i),m(i,d),m(i,g),m(i,p),re(p,r[11]),m(i,h),m(i,w),m(l,k),R&&R.m(l,null),B||(z=[N(o,"input",r[20]),N(p,"input",r[21]),N(w,"click",r[22]),N(l,"submit",r[17]),N(l,"mousedown",fn)],B=!0)},p(O,Y){Y[0]&1024&&o.value!==O[10]&&re(o,O[10]),Y[0]&2048&&p.value!==O[11]&&re(p,O[11]),O[13]&&O[13].length>0?R?R.p(O,Y):(R=zt(O),R.c(),R.m(l,null)):R&&(R.d(1),R=null)},d(O){O&&Z(e),R&&R.d(),B=!1,he(z)}}}function zt(r){let e,t,l,n,s,a,o,c,i,d=De(r[13]),g=[];for(let p=0;p<d.length;p+=1)g[p]=Lt(At(r,d,p));return{c(){e=y("div"),t=y("div"),t.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"></path></svg>`,l=C(),n=y("select"),s=y("option"),s.textContent="Select a model";for(let p=0;p<g.length;p+=1)g[p].c();a=C(),o=y("button"),o.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"></path></svg>`,f(t,"class","tlwd-flex tlwd-items-center"),s.__value="",re(s,s.__value),f(n,"id","open-webui-model-input"),f(n,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),f(n,"autocomplete","off"),n.required=!0,r[15]===void 0&&Ze(()=>r[23].call(n)),f(o,"class","tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),f(o,"type","submit"),f(e,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full tlwd-mt-2")},m(p,h){K(p,e,h),m(e,t),m(e,l),m(e,n),m(n,s);for(let w=0;w<g.length;w+=1)g[w]&&g[w].m(n,null);mt(n,r[15],!0),m(e,a),m(e,o),c||(i=N(n,"change",r[23]),c=!0)},p(p,h){if(h[0]&8192){d=De(p[13]);let w;for(w=0;w<d.length;w+=1){const k=At(p,d,w);g[w]?g[w].p(k,h):(g[w]=Lt(k),g[w].c(),g[w].m(n,null))}for(;w<g.length;w+=1)g[w].d(1);g.length=d.length}h[0]&40960&&mt(n,p[15])},d(p){p&&Z(e),Nt(g,p),c=!1,i()}}}function Lt(r){let e,t=(r[15].name??r[15].id)+"",l,n;return{c(){e=y("option"),l=de(t),e.__value=n=r[15].id,re(e,e.__value)},m(s,a){K(s,e,a),m(e,l)},p(s,a){a[0]&8192&&t!==(t=(s[15].name??s[15].id)+"")&&ot(l,t),a[0]&8192&&n!==(n=s[15].id)&&(e.__value=n,re(e,e.__value))},d(s){s&&Z(e)}}}function vt(r){let e,t,l,n,s,a,o,c,i,d,g,p,h,w,k,B,z,R,O,Y,X,Q,be,ne,V,J,ie,ze,ge,Le,se,xe,ve,oe=De(r[6]),q=[];for(let b=0;b<oe.length;b+=1)q[b]=Pt(Rt(r,oe,b));function Pe(b,_){if(b[3]&&b[7])return pn;if(b[7]&&!b[3])return dn}let ae=Pe(r),F=ae&&ae(r),x=r[9]&&r[8]&&Ct(r);return{c(){e=y("div"),t=y("div"),l=y("div"),n=y("div"),s=y("div"),s.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5 tlwd-text-neutral-300"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"></path></svg> <h3 class="tlwd-text-xl tlwd-font-semibold tlwd-text-neutral-100">AI Response</h3>`,a=C(),o=y("button"),o.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>`,c=C(),i=y("div");for(let b=0;b<q.length;b+=1)q[b].c();d=C(),F&&F.c(),g=C(),x&&x.c(),p=C(),h=y("div"),w=y("form"),k=y("input"),B=C(),z=y("button"),R=de("Send"),Y=C(),X=y("div"),Q=y("div"),Q.textContent="Press Escape to close",be=C(),ne=y("div"),V=y("button"),J=Re("svg"),ie=Re("path"),ze=de(`
                Continue in OpenWebUI`),Le=C(),se=y("button"),se.textContent="Copy conversation",f(s,"class","tlwd-flex tlwd-items-center tlwd-gap-2"),f(o,"class","tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-400 hover:tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-1 tlwd-outline-none tlwd-border-none tlwd-transition-colors"),f(o,"type","button"),f(n,"class","tlwd-flex tlwd-items-center tlwd-justify-between tlwd-mb-5 tlwd-pb-4 tlwd-border-b tlwd-border-gray-700"),f(i,"class","tlwd-flex-1 tlwd-overflow-y-auto tlwd-pr-2 tlwd-mb-4"),f(k,"id","open-webui-followup-input"),f(k,"type","text"),f(k,"placeholder","Ask a follow-up question..."),k.disabled=r[7],f(k,"class","tlwd-flex-1 tlwd-px-4 tlwd-py-3 tlwd-text-base tlwd-bg-gray-800/50 tlwd-border tlwd-border-gray-700 tlwd-rounded-lg tlwd-text-neutral-100 placeholder:tlwd-text-neutral-500 tlwd-outline-none focus:tlwd-border-gray-600 disabled:tlwd-opacity-50 disabled:tlwd-cursor-not-allowed"),f(k,"autocomplete","off"),f(z,"type","submit"),z.disabled=O=!r[5].trim()||r[7],f(z,"class","tlwd-px-5 tlwd-py-3 tlwd-text-base tlwd-font-medium tlwd-bg-blue-600 hover:tlwd-bg-blue-700 disabled:tlwd-opacity-50 disabled:tlwd-cursor-not-allowed tlwd-text-white tlwd-rounded-lg tlwd-transition-colors tlwd-outline-none tlwd-border-none"),f(w,"class","tlwd-flex tlwd-items-center tlwd-gap-2"),f(Q,"class","tlwd-text-sm tlwd-text-neutral-400"),f(ie,"stroke-linecap","round"),f(ie,"stroke-linejoin","round"),f(ie,"d","M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"),f(J,"xmlns","http://www.w3.org/2000/svg"),f(J,"fill","none"),f(J,"viewBox","0 0 24 24"),f(J,"stroke-width",2),f(J,"stroke","currentColor"),f(J,"class","tlwd-size-4"),f(V,"class","tlwd-text-sm tlwd-text-blue-400 hover:tlwd-text-blue-300 tlwd-cursor-pointer tlwd-outline-none tlwd-border-none tlwd-bg-transparent tlwd-transition-colors tlwd-flex tlwd-items-center tlwd-gap-1"),f(V,"type","button"),V.disabled=ge=r[6].length===0,f(se,"class","tlwd-text-sm tlwd-text-neutral-300 hover:tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-outline-none tlwd-border-none tlwd-bg-transparent tlwd-transition-colors"),f(se,"type","button"),f(ne,"class","tlwd-flex tlwd-items-center tlwd-gap-3"),f(X,"class","tlwd-mt-3 tlwd-flex tlwd-items-center tlwd-justify-between"),f(h,"class","tlwd-border-t tlwd-border-gray-700 tlwd-pt-3"),f(l,"role","dialog"),f(l,"aria-modal","true"),f(l,"class","tlwd-w-full tlwd-flex tlwd-flex-col tlwd-justify-between tlwd-py-5 tlwd-px-6 tlwd-rounded-2xl tlwd-outline tlwd-outline-1 tlwd-outline-gray-850 tlwd-backdrop-blur-3xl tlwd-bg-gray-850/70 shadow-4xl modal-animation tlwd-max-h-[85vh] tlwd-overflow-hidden tlwd-flex tlwd-flex-col"),f(t,"class","tlwd-m-auto tlwd-max-w-4xl tlwd-w-full tlwd-pb-32 tlwd-px-4"),f(e,"role","dialog"),f(e,"aria-modal","true"),f(e,"id","openwebui-response-modal"),f(e,"class","tlwd-fixed tlwd-top-0 tlwd-right-0 tlwd-left-0 tlwd-bottom-0 tlwd-w-full tlwd-min-h-screen tlwd-h-screen tlwd-flex tlwd-justify-center tlwd-z-[9999999999] tlwd-overflow-hidden tlwd-overscroll-contain")},m(b,_){K(b,e,_),m(e,t),m(t,l),m(l,n),m(n,s),m(n,a),m(n,o),m(l,c),m(l,i);for(let E=0;E<q.length;E+=1)q[E]&&q[E].m(i,null);m(i,d),F&&F.m(i,null),r[28](i),m(l,g),x&&x.m(l,null),m(l,p),m(l,h),m(h,w),m(w,k),re(k,r[5]),m(w,B),m(w,z),m(z,R),m(h,Y),m(h,X),m(X,Q),m(X,be),m(X,ne),m(ne,V),m(V,J),m(J,ie),m(V,ze),m(ne,Le),m(ne,se),xe||(ve=[N(o,"click",r[27]),N(k,"input",r[29]),N(w,"submit",ar(r[19])),N(V,"click",r[18]),N(se,"click",r[30]),N(l,"mousedown",wn),N(e,"mousedown",r[31])],xe=!0)},p(b,_){if(_[0]&64){oe=De(b[6]);let E;for(E=0;E<oe.length;E+=1){const D=Rt(b,oe,E);q[E]?q[E].p(D,_):(q[E]=Pt(D),q[E].c(),q[E].m(i,d))}for(;E<q.length;E+=1)q[E].d(1);q.length=oe.length}ae===(ae=Pe(b))&&F?F.p(b,_):(F&&F.d(1),F=ae&&ae(b),F&&(F.c(),F.m(i,null))),b[9]&&b[8]?x?x.p(b,_):(x=Ct(b),x.c(),x.m(l,p)):x&&(x.d(1),x=null),_[0]&128&&(k.disabled=b[7]),_[0]&32&&k.value!==b[5]&&re(k,b[5]),_[0]&160&&O!==(O=!b[5].trim()||b[7])&&(z.disabled=O),_[0]&64&&ge!==(ge=b[6].length===0)&&(V.disabled=ge)},d(b){b&&Z(e),Nt(q,b),F&&F.d(),r[28](null),x&&x.d(),xe=!1,he(ve)}}}function cn(r){let e,t,l,n,s=Qe(r[36].content)+"",a;return{c(){e=y("div"),t=y("div"),t.textContent="Assistant:",l=C(),n=y("div"),a=C(),f(t,"class","tlwd-text-sm tlwd-text-neutral-400 tlwd-mb-2"),f(n,"class","tlwd-text-base tlwd-text-neutral-100 tlwd-leading-relaxed markdown-content"),f(e,"class","tlwd-mb-5")},m(o,c){K(o,e,c),m(e,t),m(e,l),m(e,n),n.innerHTML=s,m(e,a)},p(o,c){c[0]&64&&s!==(s=Qe(o[36].content)+"")&&(n.innerHTML=s)},d(o){o&&Z(e)}}}function un(r){let e,t,l,n,s=r[36].content+"",a,o;return{c(){e=y("div"),t=y("div"),t.textContent="You:",l=C(),n=y("div"),a=de(s),o=C(),f(t,"class","tlwd-text-sm tlwd-text-neutral-400 tlwd-mb-2"),f(n,"class","tlwd-text-base tlwd-text-neutral-200 tlwd-bg-gray-800/50 tlwd-rounded-lg tlwd-p-4"),f(e,"class","tlwd-mb-5")},m(c,i){K(c,e,i),m(e,t),m(e,l),m(e,n),m(n,a),m(e,o)},p(c,i){i[0]&64&&s!==(s=c[36].content+"")&&ot(a,s)},d(c){c&&Z(e)}}}function Pt(r){let e;function t(s,a){if(s[36].role==="user")return un;if(s[36].role==="assistant")return cn}let l=t(r),n=l&&l(r);return{c(){n&&n.c(),e=qt()},m(s,a){n&&n.m(s,a),K(s,e,a)},p(s,a){l===(l=t(s))&&n?n.p(s,a):(n&&n.d(1),n=l&&l(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&Z(e),n&&n.d(s)}}}function dn(r){let e;return{c(){e=y("div"),e.innerHTML='<div class="tlwd-text-sm tlwd-text-neutral-400 tlwd-mb-2">Assistant:</div> <span class="tlwd-text-base tlwd-text-neutral-400 tlwd-italic">Waiting for response...</span>',f(e,"class","tlwd-mb-5")},m(t,l){K(t,e,l)},p:ue,d(t){t&&Z(e)}}}function pn(r){let e,t,l,n,s,a=Qe(r[3])+"",o,c;return{c(){e=y("div"),t=y("div"),t.textContent="Assistant:",l=C(),n=y("div"),s=new dr(!1),o=C(),c=y("span"),c.textContent="|",f(t,"class","tlwd-text-sm tlwd-text-neutral-400 tlwd-mb-2"),s.a=o,f(c,"class","tlwd-inline-block tlwd-w-2 tlwd-h-4 tlwd-bg-neutral-400 tlwd-ml-1 tlwd-animate-pulse"),f(n,"class","tlwd-text-base tlwd-text-neutral-100 tlwd-leading-relaxed markdown-content"),f(e,"class","tlwd-mb-5")},m(i,d){K(i,e,d),m(e,t),m(e,l),m(e,n),s.m(a,n),m(n,o),m(n,c)},p(i,d){d[0]&8&&a!==(a=Qe(i[3])+"")&&s.p(a)},d(i){i&&Z(e)}}}function Ct(r){let e,t,l,n,s,a,o;return{c(){e=y("div"),t=y("div"),l=Re("svg"),n=Re("path"),s=C(),a=y("p"),o=de(r[8]),f(n,"stroke-linecap","round"),f(n,"stroke-linejoin","round"),f(n,"d","M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"),f(l,"xmlns","http://www.w3.org/2000/svg"),f(l,"fill","none"),f(l,"viewBox","0 0 24 24"),f(l,"stroke-width",2.5),f(l,"stroke","currentColor"),f(l,"class","tlwd-size-5 tlwd-text-red-400"),f(a,"class","tlwd-text-base tlwd-text-red-300"),f(t,"class","tlwd-flex tlwd-items-center tlwd-gap-2"),f(e,"class","tlwd-mb-3 tlwd-p-3 tlwd-bg-red-900/20 tlwd-border tlwd-border-red-700/50 tlwd-rounded-lg")},m(c,i){K(c,e,i),m(e,t),m(t,l),m(l,n),m(t,s),m(t,a),m(a,o)},p(c,i){i[0]&256&&ot(o,c[8])},d(c){c&&Z(e)}}}function hn(r){let e,t,l=r[0]&&It(r),n=r[2]&&vt(r);return{c(){l&&l.c(),e=C(),n&&n.c(),t=qt()},m(s,a){l&&l.m(s,a),K(s,e,a),n&&n.m(s,a),K(s,t,a)},p(s,a){s[0]?l?l.p(s,a):(l=It(s),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),s[2]?n?n.p(s,a):(n=vt(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ue,o:ue,d(s){s&&(Z(e),Z(t)),l&&l.d(s),n&&n.d(s)}}}const fn=r=>{r.stopPropagation()},gn=r=>{r.stopPropagation()},wn=r=>{r.stopPropagation()};function mn(r,e,t){let l=!1,n=!0,s=!1,a="",o="",c="",i=[],d=!1,g="",p=!1,h="",w="",k="",B="",z=[],R=null;const O=()=>{console.log("resetConfig");try{chrome.storage.local.clear().then(()=>{console.log("Value is cleared")})}catch(x){console.log(x)}t(10,h=""),t(11,w=""),t(15,k=""),t(13,z=[]),t(1,n=!0)},Y=x=>{x.preventDefault();try{const b=new URL(h.startsWith("http")?h:`https://${h}`);if(!["http:","https:"].includes(b.protocol)){console.error("Extension: Invalid URL protocol");return}const _=encodeURIComponent(B),E=encodeURIComponent(k);window.open(`${h}/?q=${_}&models=${E}`,"_blank"),t(12,B=""),t(0,l=!1)}catch{console.error("Extension: Invalid URL format")}},X=async x=>{x.preventDefault();try{const b=new URL(h.startsWith("http")?h:`https://${h}`);if(!["http:","https:"].includes(b.protocol)){console.error("Extension: Invalid URL protocol");return}}catch{console.error("Extension: Invalid URL format");return}if(!w||typeof w!="string"||w.trim().length===0){console.error("Extension: Invalid API key");return}if(!k||typeof k!="string"||k.trim().length===0){console.error("Extension: Invalid model");return}try{const b=await chrome.runtime.sendMessage({action:"encryptApiKey",apiKey:w.trim()});b.error?(console.error("Extension: Failed to encrypt API key:",b.error),chrome.storage.local.set({url:h.trim(),key:w.trim(),model:k.trim()})):chrome.storage.local.set({url:h.trim(),key:b.encrypted,model:k.trim()}).then(()=>{console.log("Value is set (API key encrypted)")})}catch(b){console.log(b)}t(1,n=!1)},Q=async()=>{try{const x=await chrome.runtime.sendMessage({action:"getSelection"});((x==null?void 0:x.data)??!1)&&t(12,B=x.data)}catch(x){console.log("catch",x)}t(0,l=!l),setTimeout(()=>{const x=document.getElementById("open-webui-search-input");x&&x.focus()},0)},be=async x=>{var S;if(!x||x.trim().length===0){console.warn("Extension: No content to summarize"),t(8,g="No content could be extracted from this page."),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3);return}let b=h,_=w,E=k;try{const u=await chrome.storage.local.get(["url","key","model"]);if(u.url&&(b=u.url),u.model&&(E=u.model),u.key)try{const T=await chrome.runtime.sendMessage({action:"decryptApiKey",encryptedApiKey:u.key});T.error?(console.error("Extension: Failed to decrypt API key:",T.error),_=u.key):_=T.decrypted}catch(T){console.error("Extension: Error decrypting API key:",T),_=u.key}}catch(u){console.error("Extension: Error getting config:",u)}if(!b||!_||!E){console.warn("Extension: Missing configuration. Please configure the extension first."),t(1,n=!0);return}t(4,o="Summarize this page"),t(3,a=""),t(6,i=[{role:"system",content:"You are a helpful assistant that summarizes web page content. Ignore navigation menus, advertisements, cookie notices, footers, headers, and other non-content elements. Focus on the main article or content of the page. Provide a clear, concise summary. You can use markdown formatting (headers, lists, code blocks, bold, italic, etc.) to make your response more readable and well-structured."},{role:"user",content:x.substring(0,5e4)}]),t(2,s=!0),t(7,d=!0),t(9,p=!1),t(8,g="");const $=(z.length>0?((S=z.find(u=>u.id===E))==null?void 0:S.owned_by)==="openai":!1)?`${b}/openai`:`${b}/ollama/v1`;try{const[u,T]=await He(_,{model:E,messages:i,stream:!0},$);if(u&&u.ok){const j=u.body.pipeThrough(new TextDecoderStream).pipeThrough(qe(`
`)).getReader();for(;;){const{value:L,done:H}=await j.read();if(H)break;try{let A=L.split(`
`);for(const M of A)if(M!==""&&M!=="data: [DONE]"){let U=JSON.parse(M.replace(/^data: /,""));if(!("request_id"in U)){const G=U.choices[0].delta.content??"";t(3,a+=G),R&&setTimeout(()=>{t(14,R.scrollTop=R.scrollHeight,R)},0)}}}catch(A){console.log(A)}}try{a&&(i.some(H=>H.role==="assistant"&&H.content===a)||t(6,i=[...i,{role:"assistant",content:a}])),t(7,d=!1),t(3,a=""),setTimeout(()=>{const L=document.getElementById("open-webui-followup-input");L&&L.focus()},100)}catch(L){console.error("Extension: Error adding response to history:",L),t(7,d=!1)}}else console.error("Extension: API request failed:",u),t(2,s=!1),t(7,d=!1),t(8,g="Failed to get summary. Please check your configuration."),t(9,p=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)}catch(u){console.error("Extension: Error summarizing page:",u);const T=(u==null?void 0:u.message)||String(u);T.includes("Rate limit exceeded")?(t(8,g=T),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)):(t(8,g=`Error: ${T}`),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)),t(7,d=!1)}},ne=async x=>{var S;if(!x||x.trim().length===0){console.warn("Extension: No text to explain"),t(8,g="No text was selected. Please select some text and try again."),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3);return}let b=h,_=w,E=k;try{const u=await chrome.storage.local.get(["url","key","model"]);if(u.url&&(b=u.url),u.model&&(E=u.model),u.key)try{const T=await chrome.runtime.sendMessage({action:"decryptApiKey",encryptedApiKey:u.key});T.error?(console.error("Extension: Failed to decrypt API key:",T.error),_=u.key):_=T.decrypted}catch(T){console.error("Extension: Error decrypting API key:",T),_=u.key}}catch(u){console.error("Extension: Error getting config:",u)}if(!b||!_||!E){console.warn("Extension: Missing configuration. Please configure the extension first."),t(1,n=!0);return}t(4,o=x.substring(0,100)),t(3,a=""),t(6,i=[{role:"system",content:`I need help understanding a concept or term mentioned in this text: ${x}

Please explain this term/concept in simple, clear language. Provide a definition and offer examples to illustrate your point.

If there are any related ideas or concepts that I should know about, please summarize those as well.

Additionally, if you can provide any context or background information that might be helpful for understanding the term/concept, please do so.

Only use the selected text: The generated response should only use the text that was selected by the user and not include any external information unless it is directly relevant to the concept being explained.

You can use markdown formatting (headers, lists, code blocks, bold, italic, etc.) to make your explanation more readable and well-structured.`},{role:"user",content:x}]),t(2,s=!0),t(7,d=!0),t(9,p=!1),t(8,g="");const $=(z.length>0?((S=z.find(u=>u.id===E))==null?void 0:S.owned_by)==="openai":!1)?`${b}/openai`:`${b}/ollama/v1`;try{const[u,T]=await He(_,{model:E,messages:i,stream:!0},$);if(u&&u.ok){const j=u.body.pipeThrough(new TextDecoderStream).pipeThrough(qe(`
`)).getReader();for(;;){const{value:L,done:H}=await j.read();if(H)break;try{let A=L.split(`
`);for(const M of A)if(M!==""&&M!=="data: [DONE]"){let U=JSON.parse(M.replace(/^data: /,""));if(!("request_id"in U)){const G=U.choices[0].delta.content??"";t(3,a+=G),R&&setTimeout(()=>{t(14,R.scrollTop=R.scrollHeight,R)},0)}}}catch(A){console.log(A)}}try{a&&(i.some(H=>H.role==="assistant"&&H.content===a)||t(6,i=[...i,{role:"assistant",content:a}])),t(7,d=!1),t(3,a=""),setTimeout(()=>{const L=document.getElementById("open-webui-followup-input");L&&L.focus()},100)}catch(L){console.error("Extension: Error adding response to history:",L),t(7,d=!1)}}else console.error("Extension: API request failed:",u),t(2,s=!1),t(7,d=!1),t(8,g="Failed to get explanation. Please check your configuration."),t(9,p=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)}catch(u){const T=(u==null?void 0:u.message)||String(u);if(T.includes("Extension context invalidated")){t(7,d=!1),t(2,s=!1);return}console.error("Extension: Error explaining text:",u),T.includes("Rate limit exceeded")?(t(8,g=T),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)):(t(8,g=`Error: ${T}`),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)),t(7,d=!1)}},V=async()=>{var x,b;if(!h||i.length===0){console.warn("Extension: No conversation to continue or URL not configured");return}try{let _=h,E=w;try{const S=await chrome.storage.local.get(["url","key"]);if(S.url&&(_=S.url),S.key)try{const u=await chrome.runtime.sendMessage({action:"decryptApiKey",encryptedApiKey:S.key});u.error?E=S.key:E=u.decrypted}catch{E=S.key}}catch(S){console.error("Extension: Error getting config:",S)}const D=i.filter(S=>S.role!=="system");if(D.length===0){console.warn("Extension: No messages to send");return}try{const S=await chrome.runtime.sendMessage({action:"createChat",url:_,api_key:E,body:{title:((b=(x=D[0])==null?void 0:x.content)==null?void 0:b.substring(0,50))||"Extension Conversation",messages:D}});if(S.data&&S.data.id){window.open(`${_}/chat/${S.data.id}`,"_blank");return}else S.error&&console.log("Extension: Could not create chat via API, trying URL parameters:",S.error)}catch(S){console.log("Extension: Could not create chat via API, trying URL parameters:",S)}const $=D.find(S=>S.role==="user");if($){const S=encodeURIComponent($.content);window.open(`${_}/?q=${S}`,"_blank")}else window.open(_,"_blank")}catch(_){console.error("Extension: Error continuing in OpenWebUI:",_);try{const E=await chrome.storage.local.get(["url"]);E.url&&window.open(E.url,"_blank")}catch(E){console.error("Extension: Could not open OpenWebUI:",E)}}},J=async()=>{var S;if(!c.trim()||d)return;const x=c.trim();t(5,c=""),a&&(i.some(T=>T.role==="assistant"&&T.content===a)||t(6,i=[...i,{role:"assistant",content:a}])),t(6,i=[...i,{role:"user",content:x}]),t(3,a=""),t(7,d=!0),setTimeout(()=>{const u=document.getElementById("open-webui-followup-input");u&&u.focus()},100);let b=h,_=w,E=k;try{const u=await chrome.storage.local.get(["url","key","model"]);if(u.url&&(b=u.url),u.model&&(E=u.model),u.key)try{const T=await chrome.runtime.sendMessage({action:"decryptApiKey",encryptedApiKey:u.key});T.error?(console.error("Extension: Failed to decrypt API key:",T.error),_=u.key):_=T.decrypted}catch(T){console.error("Extension: Error decrypting API key:",T),_=u.key}}catch(u){u.message&&u.message.includes("Extension context invalidated")||console.log("Failed to get stored config:",u)}const $=(z.length>0?((S=z.find(u=>u.id===E))==null?void 0:S.owned_by)==="openai":!1)?`${b}/openai`:`${b}/ollama/v1`;try{const[u,T]=await He(_,{model:E,messages:i,stream:!0},$);if(u&&u.ok){const j=u.body.pipeThrough(new TextDecoderStream).pipeThrough(qe(`
`)).getReader();for(;;){const{value:L,done:H}=await j.read();if(H)break;try{let A=L.split(`
`);for(const M of A)if(M!==""&&M!=="data: [DONE]"){let U=JSON.parse(M.replace(/^data: /,""));if(!("request_id"in U)){const G=U.choices[0].delta.content??"";t(3,a+=G),R&&setTimeout(()=>{t(14,R.scrollTop=R.scrollHeight,R)},0)}}}catch(A){console.log(A)}}try{a&&(i.some(H=>H.role==="assistant"&&H.content===a)||t(6,i=[...i,{role:"assistant",content:a}])),t(7,d=!1),t(3,a=""),setTimeout(()=>{const L=document.getElementById("open-webui-followup-input");L&&L.focus()},100)}catch(L){console.error("Extension: Error adding response to history:",L),t(7,d=!1)}}else console.error("Extension: API request failed:",u),t(7,d=!1)}catch(u){console.error("Extension: Error sending follow-up:",u);const T=(u==null?void 0:u.message)||String(u);if(T.includes("Rate limit exceeded")&&(t(8,g=T),t(9,p=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)),a&&d)try{i.some(L=>L.role==="assistant"&&L.content===a)||t(6,i=[...i,{role:"assistant",content:a}])}catch(j){console.error("Extension: Could not save response:",j)}t(7,d=!1)}};hr(async()=>{if(window!==window.top)return;window.openWebUIToggleSearch=Q;const x=()=>{Q()};window.addEventListener("open-webui-toggle-search",x);const b=u=>{u.detail&&u.detail.content&&be(u.detail.content)};window.addEventListener("open-webui-summarize-page",b);let _=!1;const E=u=>{window===window.top&&!_&&u.detail&&u.detail.text&&(_=!0,ne(u.detail.text).finally(()=>{_=!1}))};window.addEventListener("open-webui-explain-text",E);let D=!1;chrome.runtime.onMessage.addListener((u,T,j)=>(u.action==="toggleSearch"?(window===window.top&&Q(),j({success:!0})):u.action==="summarizePage"?(window===window.top&&!D&&(D=!0,u.error?(console.error("Extension: Error from background script:",u.error),t(8,g=u.error),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g=""),D=!1},5e3)):u.content?be(u.content).finally(()=>{D=!1}):D=!1),j({success:!0})):u.action==="explainText"&&(window===window.top&&!_&&(_=!0,u.error?(console.error("Extension: Error from background script:",u.error),t(8,g=u.error),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g=""),_=!1},5e3)):u.text?ne(u.text).finally(()=>{_=!1}):_=!1),j({success:!0})),!0));const $=async u=>{var T;if(l&&u.shiftKey&&u.key==="Escape"?O():u.key==="Escape"&&(s?(t(2,s=!1),t(3,a=""),t(4,o=""),t(5,c=""),t(6,i=[]),t(7,d=!1)):t(0,l=!1)),u.key==="Enter"&&(u.metaKey||u.ctrlKey)&&(u.shiftKey||u.altKey)){u.preventDefault(),u.stopPropagation(),u.stopImmediatePropagation();let j=h,L=w,H=k;try{const A=await chrome.storage.local.get(["url","key","model"]);if(A.url&&(j=A.url,t(10,h=A.url)),A.model&&(H=A.model,t(15,k=A.model)),A.key)try{const M=await chrome.runtime.sendMessage({action:"decryptApiKey",encryptedApiKey:A.key});M.error?(console.error("Extension: Failed to decrypt API key:",M.error),L=A.key,t(11,w=A.key)):(L=M.decrypted,t(11,w=M.decrypted))}catch(M){console.error("Extension: Error decrypting API key:",M),L=A.key,t(11,w=A.key)}}catch(A){A.message&&A.message.includes("Extension context invalidated")||console.log("Failed to get stored config:",A)}if(!j||!L||!H){console.warn("Extension: Missing configuration. Please configure the extension first.");return}try{const A=await chrome.runtime.sendMessage({action:"getSelection"});if((A==null?void 0:A.data)??!1){t(4,o=A.data),t(3,a=""),t(6,i=[{role:"system",content:"You are a helpful assistant. You can use markdown formatting (headers, lists, code blocks, bold, italic, etc.) to make your responses more readable and well-structured."},{role:"user",content:A.data}]),t(2,s=!0),t(7,d=!0);const M=document.activeElement;let U=null;M&&(M.tagName==="INPUT"||M.tagName==="TEXTAREA")&&(U=M);let G=null;U&&(G=U.id||`open-webui-target-${Date.now()}`,U.id||(U.id=G));const nr=(z.length>0?((T=z.find(Ve=>Ve.id===H))==null?void 0:T.owned_by)==="openai":!1)?`${j}/openai`:`${j}/ollama/v1`,[Ce,_n]=await He(L,{model:H,messages:i,stream:!0},nr);if(Ce&&Ce.ok){const Ve=Ce.body.pipeThrough(new TextDecoderStream).pipeThrough(qe(`
`)).getReader();let lr=!1;for(;;){const{value:ce,done:Me}=await Ve.read();if(Me)break;try{let Je=ce.split(`
`);for(const Be of Je)if(Be!=="")if(console.log(Be),Be==="data: [DONE]")console.log("DONE"),lr=!0;else{let Oe=JSON.parse(Be.replace(/^data: /,""));if(console.log(Oe),"request_id"in Oe)console.log(Oe.request_id);else{const $e=Oe.choices[0].delta.content??"";t(3,a+=$e),R&&setTimeout(()=>{t(14,R.scrollTop=R.scrollHeight,R)},0),G&&$e&&await chrome.runtime.sendMessage({action:"writeText",text:$e,targetId:G})}}}catch(Je){console.log(Je)}}try{a&&(i.some(Me=>Me.role==="assistant"&&Me.content===a)||t(6,i=[...i,{role:"assistant",content:a}])),t(7,d=!1),t(3,a=""),setTimeout(()=>{const ce=document.getElementById("open-webui-followup-input");ce&&ce.focus()},100)}catch(ce){console.error("Extension: Error adding response to history:",ce),t(7,d=!1)}}else console.error("Extension: API request failed:",Ce),t(2,s=!1),t(7,d=!1)}}catch(A){console.error("Extension: Error getting AI response:",A);const M=(A==null?void 0:A.message)||String(A);if(M.includes("Rate limit exceeded")&&(t(8,g=M),t(9,p=!0),t(2,s=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)),a&&d)try{i.some(G=>G.role==="assistant"&&G.content===a)||t(6,i=[...i,{role:"assistant",content:a}])}catch(U){console.error("Extension: Could not save response:",U)}t(7,d=!1)}}};document.addEventListener("keydown",$,{capture:!0,passive:!1});let S=null;try{S=await chrome.storage.local.get()}catch(u){console.log(u)}if(S){if(t(10,h=S.url??""),t(15,k=S.model??""),S.key)try{const u=await chrome.runtime.sendMessage({action:"decryptApiKey",encryptedApiKey:S.key});u.error?(console.error("Extension: Failed to decrypt API key:",u.error),t(11,w=S.key)):t(11,w=u.decrypted)}catch(u){console.error("Extension: Error decrypting API key:",u),t(11,w=S.key)}else t(11,w="");if(S.url&&w&&S.model){if(t(1,n=!1),z.length===0)try{t(13,z=await bt(w,S.url))}catch(u){const T=(u==null?void 0:u.message)||String(u);!T.includes("CORS")&&!T.includes("Failed to fetch")&&!T.includes("Rate limit exceeded")&&!T.includes("Extension context invalidated")&&console.log("Failed to load models (non-critical):",u)}}else t(1,n=!0)}else t(1,n=!0);return()=>{document.removeEventListener("keydown",$),window.removeEventListener("open-webui-toggle-search",x),window.removeEventListener("open-webui-summarize-page",b),window.removeEventListener("open-webui-explain-text",E),delete window.openWebUIToggleSearch}});function ie(){h=this.value,t(10,h)}function ze(){w=this.value,t(11,w)}const ge=async()=>{h.endsWith("/")&&t(10,h=h.slice(0,-1));try{t(13,z=await bt(w,h)),t(9,p=!1),t(8,g="")}catch(x){const b=(x==null?void 0:x.message)||String(x);b.includes("Rate limit exceeded")?(t(8,g=b),t(9,p=!0),setTimeout(()=>{t(9,p=!1),t(8,g="")},5e3)):console.error("Extension: Error fetching models:",x)}};function Le(){k=ur(this),t(15,k),t(13,z)}function se(){B=this.value,t(12,B)}const xe=()=>{t(1,n=!0)},ve=()=>{t(0,l=!1)},oe=()=>{t(2,s=!1),t(3,a=""),t(4,o=""),t(5,c=""),t(6,i=[]),t(7,d=!1)};function q(x){tt[x?"unshift":"push"](()=>{R=x,t(14,R)})}function Pe(){c=this.value,t(5,c)}return[l,n,s,a,o,c,i,d,g,p,h,w,B,z,R,k,Y,X,V,J,ie,ze,ge,Le,se,xe,ve,oe,q,Pe,()=>{const x=i.filter(b=>b.role!=="system").map(b=>`${b.role==="user"?"You":"Assistant"}: ${b.content}`).join(`

`);navigator.clipboard.writeText(x)},()=>{t(2,s=!1),t(3,a=""),t(4,o=""),t(5,c=""),t(6,i=[]),t(7,d=!1)}]}class kn extends Ft{constructor(e){super(),Kt(this,e,mn,hn,Ht,{},null,[-1,-1])}}function bn(r){let e,t,l;return t=new kn({}),{c(){e=y("div"),xr(t.$$.fragment),f(e,"class","extension-container")},m(n,s){K(n,e,s),Zt(t,e,null),l=!0},p:ue,i(n){l||(Ut(t.$$.fragment,n),l=!0)},o(n){br(t.$$.fragment,n),l=!1},d(n){n&&Z(e),Dt(t)}}}class xn extends Ft{constructor(e){super(),Kt(this,e,null,bn,Ht,{})}}const Mt="__openwebui_extension_initialized";function Ge(){if(window!==window.top||window[Mt])return null;const r=document.getElementById("extension-app");if(r){if(r.__svelte_app)return r.__svelte_app;const e=new xn({target:r});return r.__svelte_app=e,window[Mt]=!0,e}else return console.warn("Extension app target element not found, retrying..."),setTimeout(Ge,100),null}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ge):Ge();Ge();
